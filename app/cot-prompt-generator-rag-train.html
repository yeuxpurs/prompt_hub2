<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ìë™ì°¨ ê³µí•™ ë¬¸ì œ í•´ê²° í”„ë¡¬í”„íŠ¸ ìƒì„±ê¸°</title>
  <style>
    /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì„¤ì • */
    :root {
      --bg: #f8f9fa;
      --card: #ffffff;
      --ink: #212529;
      --muted: #6c757d;
      --brand: #0d6efd;
      --ok: #198754;
      --warn: #ffc107;
      --danger: #dc3545;
      --radius: 12px;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    /* ê¸°ë³¸ ë°•ìŠ¤ ëª¨ë¸ë§ ë° í°íŠ¸ ì„¤ì • */
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--ink);
      font-family: "Pretendard", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }
    /* ë ˆì´ì•„ì›ƒ ë° ì¹´ë“œ ìŠ¤íƒ€ì¼ */
    .wrap { max-width: 1200px; margin: 32px auto; padding: 0 24px; }
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 24px;
    }
    .title { font-weight: 700; font-size: 24px; }
    .subtitle { color: var(--muted); font-size: 14px; }
    .grid { display: grid; grid-template-columns: 1fr 1.2fr; gap: 24px; }
    @media (max-width: 980px) { .grid { grid-template-columns: 1fr; } }
    .card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 24px;
      border: 1px solid #dee2e6;
    }
    .card h3 { margin: 0 0 16px; font-size: 18px; font-weight: 600; }
    /* ê·¸ë¦¬ë“œ ë° í¼ ìš”ì†Œ ìŠ¤íƒ€ì¼ */
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px; }
    .row:last-child { margin-bottom: 0; }
    .row-stack { display: flex; flex-direction: column; gap: 10px; }
    label { font-size: 13px; color: var(--muted); display: block; margin-bottom: 8px; font-weight: 500; }
    input[type="text"], input[type="number"], input[type="date"], textarea, select {
      width: 100%;
      padding: 10px 14px;
      border-radius: 8px;
      border: 1px solid #ced4da;
      background: #fff;
      font-size: 14px;
      color: var(--ink);
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.2);
    }
    textarea { resize: vertical; min-height: 90px; }
    /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .btns { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 8px; }
    .btn {
      appearance: none;
      border: 0;
      border-radius: 8px;
      padding: 10px 16px;
      font-weight: 600;
      cursor: pointer;
      background: var(--brand);
      color: #fff;
      transition: background-color 0.2s, transform 0.1s;
      font-size: 14px;
    }
    .btn:hover { background: #0b5ed7; }
    .btn:active { transform: translateY(1px); }
    .btn.secondary { background: #e9ecef; color: #212529; }
    .btn.secondary:hover { background: #d3d9df; }
    /* ì¶œë ¥ ì˜ì—­ ìŠ¤íƒ€ì¼ */
    .out {
      white-space: pre-wrap;
      background: #212529;
      color: #f8f9fa;
      padding: 16px;
      border-radius: 8px;
      font-family: "D2Coding", "Consolas", monospace;
      font-size: 13px;
      line-height: 1.7;
      overflow: auto;
      min-height: 240px;
      border: 1px solid #495057;
    }
    .pill { font-size: 12px; font-weight: 500; color: #495057; background: #e9ecef; border-radius: 999px; padding: 6px 10px; display: inline-block; }
    .hr { height: 1px; background: #e9ecef; margin: 24px 0; }
    .kbd { font-family: monospace; font-size: 12px; background: #e9ecef; color: #212529; padding: 3px 6px; border-radius: 4px; border: 1px solid #dee2e6;}
    /* ì•Œë¦¼ ë©”ì‹œì§€(Toast) ìŠ¤íƒ€ì¼ */
    #toast {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #333;
      color: #fff;
      padding: 14px 24px;
      border-radius: 50px;
      font-size: 14px;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s, visibility 0.5s, bottom 0.5s;
    }
    #toast.show {
      opacity: 1;
      visibility: visible;
      bottom: 50px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <div class="title">ğŸš— ìë™ì°¨ ê³µí•™ ë¬¸ì œ í•´ê²° í”„ë¡¬í”„íŠ¸ ìƒì„±ê¸°</div>
        <div class="subtitle">ê¸°ìˆ  ë¬¸ì„œ ê²€ìƒ‰ ë° ë³´ê³ ì„œ ìƒì„±ì„ ìœ„í•œ í”„ë¡¬í”„íŠ¸ë¥¼ ì²´ê³„ì ìœ¼ë¡œ êµ¬ì„±í•©ë‹ˆë‹¤.</div>
      </div>
    </header>

    <div class="grid">
      <!-- ì…ë ¥ íŒ¨ë„ -->
      <section class="card">
        <h3>1. ë¶„ì„ ëª©í‘œ ì„¤ì •</h3>
        <div class="row">
          <div>
            <label>ë‚˜ì˜ ì—­í•  (Persona)</label>
            <input id="role" type="text" placeholder="ì˜ˆ: íŒŒì›ŒíŠ¸ë ˆì¸ í’ˆì§ˆ ì—”ì§€ë‹ˆì–´" oninput="buildPrompt()" />
          </div>
          <div>
            <label>í•µì‹¬ ëª©í‘œ (Goal)</label>
            <input id="goal" type="text" placeholder="ì˜ˆ: 'í”¼ë‹‰ìŠ¤' í”„ë¡œì íŠ¸ ì—”ì§„ ê³¼ì—´ ì›ì¸ ë¶„ì„ ë³´ê³ ì„œ ì´ˆì•ˆ" oninput="buildPrompt()" />
          </div>
        </div>
        <div class="row">
          <div>
            <label>ì£¼ìš” ì •ë³´ (Context)</label>
            <textarea id="context" placeholder="ì˜ˆ: í”¼ë‹‰ìŠ¤(Phoenix) í”„ë¡œì íŠ¸, 2.5L ê°€ì†”ë¦° í„°ë³´, ë‚´êµ¬ ì‹œí—˜ ì¤‘ íŠ¹ì • ì¡°ê±´ì—ì„œ ê³¼ì—´ ë°œìƒ" oninput="suggestQueries(); buildPrompt()"></textarea>
          </div>
          <div>
            <label>ê²°ê³¼ë¬¼ ì œì•½ ì¡°ê±´ (Constraints)</label>
            <textarea id="constraints" placeholder="ì˜ˆ: Markdown í˜•ì‹, í‘œì™€ ê¸€ë¨¸ë¦¬ ê¸°í˜¸ ì‚¬ìš©, ì›ì¸-ê²°ê³¼ êµ¬ì¡°ë¡œ ëª…í™•íˆ ì„œìˆ " oninput="buildPrompt()"></textarea>
          </div>
        </div>
        <div class="hr"></div>
        <h3>2. ê²€ìƒ‰ ì¡°ê±´</h3>
        <div class="row">
          <div>
            <label>í•µì‹¬ ì—”í‹°í‹°/í‚¤ì›Œë“œ (ì‰¼í‘œ êµ¬ë¶„)</label>
            <input id="entities" type="text" placeholder="ì˜ˆ: ì—”ì§„ ê³¼ì—´, ëƒ‰ê°ìˆ˜, ë¼ë””ì—ì´í„°, ì„œëª¨ìŠ¤íƒ¯, ì›Œí„°íŒí”„" oninput="suggestQueries(); buildPrompt()" />
          </div>
          <div class="row">
             <div>
                <label>ê¸°ê°„ (ì‹œì‘)</label>
                <input id="time_from" type="date" oninput="buildPrompt()" />
              </div>
              <div>
                <label>ê¸°ê°„ (ì¢…ë£Œ)</label>
                <input id="time_to" type="date" oninput="buildPrompt()" />
              </div>
          </div>
        </div>
        <div class="row">
          <div>
            <label>ê²€ìƒ‰ ëŒ€ìƒ ë°ì´í„°ì†ŒìŠ¤</label>
            <div class="row-stack">
              <div><input type="checkbox" id="src_tech_docs" checked onchange="buildPrompt()"/> <label for="src_tech_docs">ê¸°ìˆ  ë¬¸ì„œ ì„œë²„</label></div>
              <div><input type="checkbox" id="src_test_reports" checked onchange="buildPrompt()"/> <label for="src_test_reports">ì‹œí—˜ ê²°ê³¼ ë°ì´í„°ë² ì´ìŠ¤</label></div>
              <div><input type="checkbox" id="src_email" onchange="buildPrompt()"/> <label for="src_email">ì´ë©”ì¼ ì•„ì¹´ì´ë¸Œ</label></div>
            </div>
          </div>
          <div>
            <label>ê²€ìƒ‰ ì •í™•ë„</label>
            <select id="search_mode" onchange="buildPrompt()">
              <option value="hybrid" selected>Hybrid (í‚¤ì›Œë“œ + ì˜ë¯¸ ê¸°ë°˜)</option>
              <option value="keyword">í‚¤ì›Œë“œ ê¸°ë°˜</option>
              <option value="semantic">ì˜ë¯¸ ê¸°ë°˜ (Semantic)</option>
            </select>
          </div>
        </div>
        <div class="hr"></div>
        <h3>3. ìƒì„¸ ì§ˆì˜ ìƒì„±</h3>
        <div class="row">
          <div>
            <label>ìƒì„±ëœ ê²€ìƒ‰ ì§ˆì˜ (í•„ìš”ì‹œ ìˆ˜ì •)</label>
            <textarea id="queries" placeholder="ì—”í‹°í‹°ì™€ ì»¨í…ìŠ¤íŠ¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìë™ ìƒì„±ë©ë‹ˆë‹¤."></textarea>
            <div class="btns">
              <button class="btn secondary" onclick="suggestQueries()">ì§ˆì˜ ìë™ ìƒì„±</button>
            </div>
          </div>
          <div>
            <label>ê°€ìƒ ë‹µë³€ (Hypothetical Answer)</label>
            <textarea id="hyde" placeholder="ìë™ ìƒì„±ëœ ì§ˆì˜ì— ëŒ€í•œ ê°€ìƒ ë‹µë³€ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤." readonly></textarea>
          </div>
        </div>
      </section>

      <!-- ì¶œë ¥ íŒ¨ë„ -->
      <section class="card">
        <h3>ìµœì¢… í”„ë¡¬í”„íŠ¸</h3>
        <div class="btns" style="margin-bottom:16px">
          <button class="btn" onclick="buildPrompt()">ì¬ìƒì„±</button>
          <button class="btn secondary" onclick="copyAll()">ì „ì²´ ë³µì‚¬</button>
          <button class="btn secondary" onclick="clearAll()">ì´ˆê¸°í™”</button>
        </div>

        <div class="pill">[SYSTEM PROMPT]</div>
        <div id="prompt_out" class="out" aria-label="prompt output"></div>
      </section>
    </div>
  </div>

  <!-- ì•Œë¦¼ ë©”ì‹œì§€ìš© div -->
  <div id="toast"></div>

  <script>
    // --- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ---
    /**
     * ë°°ì—´ì—ì„œ ì¤‘ë³µëœ ìš”ì†Œë¥¼ ì œê±°í•©ë‹ˆë‹¤.
     * @param {Array} arr - ì¤‘ë³µì„ ì œê±°í•  ë°°ì—´
     * @returns {Array} ì¤‘ë³µì´ ì œê±°ëœ ìƒˆ ë°°ì—´
     */
    const uniq = (arr) => [...new Set(arr.filter(Boolean))];

    /**
     * í…ìŠ¤íŠ¸ë¥¼ í† í°í™”í•˜ê³  ë¶ˆìš©ì–´ë¥¼ ì œê±°í•©ë‹ˆë‹¤.
     * @param {string} text - í† í°í™”í•  í…ìŠ¤íŠ¸
     * @returns {string[]} í† í° ë°°ì—´
     */
    const tokenize = (text) => {
      const STOPWORDS = new Set(["ê·¸ë¦¬ê³ ", "ë˜í•œ", "ë°", "ê´€ë ¨", "ëŒ€í•´", "a", "the", "in", "on"]);
      return uniq(
        text
          .toLowerCase()
          .split(/[\s,./;()\[\]{}<>~]+/)
          .map(t => t.trim())
          .filter(t => t && t.length > 1 && !STOPWORDS.has(t))
      );
    };
    
    /**
     * í™”ë©´ì— ì•Œë¦¼ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
     * @param {string} message - í‘œì‹œí•  ë©”ì‹œì§€
     * @param {number} duration - ë©”ì‹œì§€ í‘œì‹œ ì‹œê°„ (ms)
     */
    const showToast = (message, duration = 2000) => {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.classList.add('show');
        setTimeout(() => {
            toast.classList.remove('show');
        }, duration);
    };

    // --- í•µì‹¬ ë¡œì§ í•¨ìˆ˜ ---

    /**
     * ì…ë ¥ëœ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê²€ìƒ‰ ì§ˆì˜ë¥¼ ìë™ìœ¼ë¡œ ì œì•ˆí•©ë‹ˆë‹¤.
     */
    function suggestQueries() {
      const role = document.getElementById('role').value.trim();
      const goal = document.getElementById('goal').value.trim();
      const context = document.getElementById('context').value.trim();
      const entities = document.getElementById('entities').value.trim();
      
      const SYNONYMS = {
          "ì—”ì§„ ê³¼ì—´": ["ì—”ì§„ ì˜¨ë„ ìƒìŠ¹", "overheating"],
          "ëƒ‰ê°ìˆ˜": ["coolant", "ë¶€ë™ì•¡"],
          "ë¼ë””ì—ì´í„°": ["radiator", "ë°©ì—´ê¸°"],
          "ì„œëª¨ìŠ¤íƒ¯": ["thermostat", "ì˜¨ë„ì¡°ì ˆì¥ì¹˜"],
          "í”¼ë‹‰ìŠ¤": ["Phoenix", "PX"],
      };

      const tokens = uniq([
        ...tokenize(role), ...tokenize(goal), ...tokenize(context), ...tokenize(entities)
      ]);

      // ë™ì˜ì–´/ì•½ì–´ í™•ì¥
      const expanded = new Set(tokens);
      tokens.forEach(t => {
        if (SYNONYMS[t]) {
          SYNONYMS[t].forEach(s => expanded.add(s));
        }
      });

      const base = Array.from(expanded).slice(0, 10);
      
      // ê°„ë‹¨í•œ ì§ˆì˜ í…œí”Œë¦¿
      const queries = [];
      if (base.length > 2) {
        queries.push(`'${base[0]}' ì›ì¸ ë¶„ì„ ê¸°ìˆ  ë¬¸ì„œ`);
        queries.push(`'${base[0]}' ê´€ë ¨ '${base[1]}' ì‹œí—˜ ê²°ê³¼ ë³´ê³ ì„œ`);
        queries.push(`'${base.slice(0, 3).join(' ')}' ë¬¸ì œ í•´ê²° ì´ë ¥`);
      }
      queries.push(`${goal}`);

      document.getElementById('queries').value = uniq(queries).filter(Boolean).join('\n');

      // HyDE (ê°€ìƒ ë‹µë³€) ìƒì„±
      const hyde = `ê°€ìƒ ë‹µë³€(Hypothetical Answer) ì˜ˆì‹œ:\n\n'í”¼ë‹‰ìŠ¤' í”„ë¡œì íŠ¸ì˜ ì—”ì§„ ê³¼ì—´ ë¬¸ì œëŠ” ì£¼ë¡œ ê³ ë¶€í•˜ ì£¼í–‰ ì¡°ê±´ì—ì„œ ëƒ‰ê° ì‹œìŠ¤í…œì˜ íš¨ìœ¨ ì €í•˜ë¡œ ì¸í•´ ë°œìƒí–ˆë‹¤. íŠ¹íˆ, ë¼ë””ì—ì´í„°ì˜ ì„¤ê³„ ìš©ëŸ‰ ë¶€ì¡±ê³¼ ì„œëª¨ìŠ¤íƒ¯ì˜ ì˜¤ì‘ë™ ì‚¬ë¡€ê°€ ì£¼ìš” ì›ì¸ìœ¼ë¡œ ì§€ëª©ë˜ì—ˆë‹¤. ê´€ë ¨ ë‚´êµ¬ ì‹œí—˜ ë°ì´í„°(Test-Report-11B)ì—ì„œ í•´ë‹¹ í˜„ìƒì´ ì¬í˜„ë˜ì—ˆìœ¼ë©°, ê°œì„ ëœ ë¼ë””ì—ì´í„° ì ìš© í›„ ë¬¸ì œê°€ í•´ê²°ëœ ê²ƒìœ¼ë¡œ ê¸°ë¡ë˜ì–´ ìˆë‹¤.`;
      document.getElementById('hyde').value = hyde;
    }

    /**
     * ì„ íƒëœ ë°ì´í„°ì†ŒìŠ¤ ëª©ë¡ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
     * @returns {string[]} ë°ì´í„°ì†ŒìŠ¤ ì´ë¦„ ë°°ì—´
     */
    function getSelectedSources() {
      const sources = [];
      if (document.getElementById('src_tech_docs').checked) sources.push('ê¸°ìˆ  ë¬¸ì„œ ì„œë²„');
      if (document.getElementById('src_test_reports').checked) sources.push('ì‹œí—˜ ê²°ê³¼ DB');
      if (document.getElementById('src_email').checked) sources.push('ì´ë©”ì¼ ì•„ì¹´ì´ë¸Œ');
      return sources;
    }

    /**
     * ëª¨ë“  ì…ë ¥ê°’ì„ ì¢…í•©í•˜ì—¬ ìµœì¢… í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
     */
    function buildPrompt() {
      const role = document.getElementById('role').value.trim();
      const goal = document.getElementById('goal').value.trim();
      const context = document.getElementById('context').value.trim();
      const constraints = document.getElementById('constraints').value.trim();
      const entities = document.getElementById('entities').value.trim();
      const timeFrom = document.getElementById('time_from').value;
      const timeTo = document.getElementById('time_to').value;
      const sources = getSelectedSources();
      const searchMode = document.getElementById('search_mode').value;
      const queries = document.getElementById('queries').value.trim().split(/\n+/).filter(Boolean);

      // ê° ì„¹ì…˜ë³„ë¡œ í”„ë¡¬í”„íŠ¸ ë‚´ìš©ì„ êµ¬ì„±í•©ë‹ˆë‹¤.
      const systemInstructions = [
        `ë„ˆëŠ” ìµœê³ ì˜ ${role || 'ìë™ì°¨ ê³µí•™ ì „ë¬¸ê°€'}ë‹¤.`,
        `ì£¼ì–´ì§„ ì •ë³´ì™€ ê²€ìƒ‰ ê³„íšì— ë”°ë¼, ì‚¬ìš©ìì˜ ëª©í‘œ ë‹¬ì„±ì„ ë„ì™€ì•¼ í•œë‹¤.`,
        `ëª¨ë“  ë‹µë³€ì€ ë°˜ë“œì‹œ ê²€ìƒ‰ëœ ë‚´ë¶€ ê¸°ìˆ  ë¬¸ì„œì— ê·¼ê±°í•´ì•¼ í•˜ë©°, ì¶”ì¸¡ì€ ê¸ˆì§€ëœë‹¤.`,
        `ë‹µë³€ì€ í•œêµ­ì–´ë¡œ ì‘ì„±í•œë‹¤.`
      ].join('\n');

      const goalAndContext = [
        `## 1. ìµœì¢… ëª©í‘œ (GOAL)`,
        `${goal || '(ëª©í‘œê°€ ì…ë ¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤)'}`,
        `\n## 2. ë°°ê²½ ì •ë³´ (CONTEXT)`,
        `${context || '(ë°°ê²½ ì •ë³´ê°€ ì…ë ¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤)'}`,
        `\n## 3. í•µì‹¬ í‚¤ì›Œë“œ`,
        `${entities || '(í‚¤ì›Œë“œê°€ ì…ë ¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤)'}`
      ].join('\n');

      const retrievalPlan = [
        `## 4. ê²€ìƒ‰ ê³„íš (RETRIEVAL PLAN)`,
        `- ê²€ìƒ‰ ê¸°ê°„: ${timeFrom || 'ì „ì²´'} ~ ${timeTo || 'í˜„ì¬'}`,
        `- ê²€ìƒ‰ ëŒ€ìƒ: ${sources.join(', ') || 'ì „ì²´ ë°ì´í„°ì†ŒìŠ¤'}`,
        `- ê²€ìƒ‰ ë°©ì‹: ${searchMode}`,
        `- ìƒì„¸ ì§ˆì˜:`,
        ...(queries.length ? queries.map((q, i) => `  - ${q}`) : ['  - (ìƒì„±ëœ ì§ˆì˜ê°€ ì—†ìŠµë‹ˆë‹¤)'])
      ].join('\n');

      const outputFormat = [
        `## 5. ê²°ê³¼ë¬¼ í˜•ì‹ (OUTPUT FORMAT)`,
        `ì•„ë˜ ì§€ì¹¨ì— ë”°ë¼ ìµœì¢… ê²°ê³¼ë¬¼ì„ ìƒì„±í•´ì¤˜.`,
        `- ëª¨ë“  ì£¼ì¥ì˜ ê·¼ê±°ê°€ ë˜ëŠ” ë¬¸ì„œ ì •ë³´ë¥¼ ë°˜ë“œì‹œ ì¸ìš©([Source 1], [Source 2] í˜•ì‹)í•´ì•¼ í•œë‹¤.`,
        `- ì¶©ë¶„í•œ ê·¼ê±°ë¥¼ ì°¾ì§€ ëª»í–ˆë‹¤ë©´, 'ê´€ë ¨ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ'ì´ë¼ê³  ëª…í™•íˆ ë°íŒë‹¤.`,
        `- ${constraints || 'Markdownì„ ì‚¬ìš©í•˜ì—¬ ê°€ë…ì„± ë†’ê²Œ ì‘ì„±í•œë‹¤.'}`
      ].join('\n');

      // ìµœì¢… í”„ë¡¬í”„íŠ¸ ì¡°í•©
      const finalPrompt = [
        `[SYSTEM INSTRUCTIONS]`,
        systemInstructions,
        `\n--------------------------------\n`,
        `[USER REQUEST]`,
        goalAndContext,
        `\n`,
        retrievalPlan,
        `\n`,
        outputFormat,
      ].join('\n');

      document.getElementById('prompt_out').textContent = finalPrompt;
    }

    /**
     * ìƒì„±ëœ í”„ë¡¬í”„íŠ¸ë¥¼ í´ë¦½ë³´ë“œì— ë³µì‚¬í•©ë‹ˆë‹¤.
     */
    function copyAll() {
      const promptText = document.getElementById('prompt_out').textContent;
      // execCommandëŠ” ì˜¤ë˜ëœ ë°©ì‹ì´ì§€ë§Œ iframe í™˜ê²½ì—ì„œ í˜¸í™˜ì„±ì´ ë” ì¢‹ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      try {
        const textarea = document.createElement('textarea');
        textarea.value = promptText;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        showToast('âœ… í”„ë¡¬í”„íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
      } catch (err) {
        // navigator.clipboardê°€ ì‹¤íŒ¨í•  ê²½ìš°ë¥¼ ëŒ€ë¹„í•œ í´ë°±
        console.error('Copy failed:', err);
        showToast('âŒ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
      }
    }
    
    /**
     * ëª¨ë“  ì…ë ¥ í•„ë“œë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
     */
    function clearAll() {
      const inputIds = ['role', 'goal', 'context', 'constraints', 'entities', 'time_from', 'time_to', 'queries', 'hyde'];
      inputIds.forEach(id => {
        const el = document.getElementById(id);
        if (el) el.value = '';
      });
      // ì²´í¬ë°•ìŠ¤ ì´ˆê¸°í™”
      document.getElementById('src_tech_docs').checked = true;
      document.getElementById('src_test_reports').checked = true;
      document.getElementById('src_email').checked = false;
      
      buildPrompt();
      showToast('ğŸ”„ ì…ë ¥ í•„ë“œë¥¼ ì´ˆê¸°í™”í–ˆìŠµë‹ˆë‹¤.');
    }

    // --- í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™” ---
    window.addEventListener('DOMContentLoaded', () => {
      buildPrompt();
    });
  </script>
</body>
</html>
